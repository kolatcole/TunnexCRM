2020-09-12 06:15:47.303 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 06:15:47.689 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/values  
2020-09-12 06:15:47.892 +01:00 [Information] Request finished in 208.8734ms 404 
2020-09-12 06:15:49.309 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/index.html  
2020-09-12 06:15:49.371 +01:00 [Information] Request finished in 62.9646ms 200 text/html;charset=utf-8
2020-09-12 06:15:50.161 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/v1/swagger.json  
2020-09-12 06:15:50.419 +01:00 [Information] Request finished in 257.5928ms 200 application/json;charset=utf-8
2020-09-12 06:16:10.843 +01:00 [Information] Request starting HTTP/2.0 POST https://localhost:44363/api/Sale/ReturnProduct application/json 460
2020-09-12 06:16:10.872 +01:00 [Information] CORS policy execution successful.
2020-09-12 06:16:10.874 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:16:10.933 +01:00 [Information] Route matched with "{action = \"ReturnProduct\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReturnProduct(CRMSystem.Domains.ReturnedStock)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 06:16:12.204 +01:00 [Warning] No type was specified for the decimal column '"Tax"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:16:12.204 +01:00 [Warning] No type was specified for the decimal column '"TaxPercent"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:16:12.204 +01:00 [Warning] No type was specified for the decimal column '"Amount"' on entity type '"Item"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:16:12.204 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:16:12.204 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:16:12.205 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:16:12.205 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:16:12.205 +01:00 [Warning] No type was specified for the decimal column '"NairaEquivalent"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:16:12.205 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountForeign"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:16:12.205 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountNaira"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:16:12.205 +01:00 [Warning] No type was specified for the decimal column '"CompetencyValue"' on entity type '"StaffSkillorKPI"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:16:12.257 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 06:16:13.439 +01:00 [Information] Executed DbCommand ("118"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 06:16:13.669 +01:00 [Information] Executed DbCommand ("12"ms) [Parameters=["@__invID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[Amount0], [t].[Code], [t].[DateCreated1], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [c].[ID] AS [ID1], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated1], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE [s].[InvoiceID] = @__invID_0
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID1] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID1], [i0].[ID]"
2020-09-12 06:16:13.933 +01:00 [Information] Executed DbCommand ("6"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Carts] ([Amount], [Code], [DateCreated], [DateModified], [TransactionType], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ID]
FROM [Carts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:16:14.004 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:16:14.039 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:16:14.049 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:16:14.054 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:16:14.073 +01:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:16:14.077 +01:00 [Information] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:16:14.090 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@__data_ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(2) [c].[ID], [c].[Amount], [c].[Code], [c].[DateCreated], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
FROM [Carts] AS [c]
WHERE [c].[ID] = @__data_ID_0"
2020-09-12 06:16:14.095 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@p7='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Carts] SET [Amount] = @p0, [Code] = @p1, [DateCreated] = @p2, [DateModified] = @p3, [TransactionType] = @p4, [UserCreated] = @p5, [UserModified] = @p6
WHERE [ID] = @p7;
SELECT @@ROWCOUNT;"
2020-09-12 06:16:14.729 +01:00 [Error] Failed executing DbCommand ("606"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Decimal)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ReturnedStocks] ([CartID], [DateCreated], [InvoiceNo], [RefundAmount])
VALUES (@p0, @p1, @p2, @p3);
SELECT [ID]
FROM [ReturnedStocks]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:16:14.988 +01:00 [Error] An exception occurred in the database while saving changes for context type '"CRMSystem.Infrastructure.TContext"'."
""Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint \"FK_ReturnedStocks_Carts_CartID\". The conflict occurred in database \"CRMSystemDb\", table \"dbo.Carts\", column 'ID'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:220bb676-d2d7-4566-b78f-6e3a637799ab
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ReturnedStocks_Carts_CartID". The conflict occurred in database "CRMSystemDb", table "dbo.Carts", column 'ID'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:220bb676-d2d7-4566-b78f-6e3a637799ab
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2020-09-12 06:16:15.023 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)" in 4077.8441ms
2020-09-12 06:16:15.024 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:16:15.387 +01:00 [Error] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ReturnedStocks_Carts_CartID". The conflict occurred in database "CRMSystemDb", table "dbo.Carts", column 'ID'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:220bb676-d2d7-4566-b78f-6e3a637799ab
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at CRMSystem.Infrastructure.ReturnedStockRepo.insertAsync(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Infrastructure.Core\Repository\ReturnedStockRepo.cs:line 55
   at CRMSystem.Domains.SaleService.CreateRefund(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Domains.Core\Implementations\SaleService.cs:line 412
   at CRMSystem.Presentation.SaleController.ReturnProduct(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\TunnexCRM\Controllers\SaleController.cs:line 150
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-09-12 06:16:15.413 +01:00 [Information] Request finished in 4571.1182ms 500 text/plain
2020-09-12 06:20:10.024 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 06:20:10.660 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/values  
2020-09-12 06:20:11.353 +01:00 [Information] Request finished in 699.3119ms 404 
2020-09-12 06:20:17.751 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/  
2020-09-12 06:20:17.766 +01:00 [Information] Request finished in 18.6059ms 404 
2020-09-12 06:20:24.789 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger  
2020-09-12 06:20:24.816 +01:00 [Information] Request finished in 18.3897ms 301 
2020-09-12 06:20:24.822 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/index.html  
2020-09-12 06:20:24.904 +01:00 [Information] Request finished in 82.6199ms 200 text/html;charset=utf-8
2020-09-12 06:20:25.394 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/swagger-ui.css  
2020-09-12 06:20:25.405 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/swagger-ui-bundle.js  
2020-09-12 06:20:25.413 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/swagger-ui-standalone-preset.js  
2020-09-12 06:20:25.948 +01:00 [Information] Sending file. Request path: '"/swagger-ui-standalone-preset.js"'. Physical path: '"N/A"'
2020-09-12 06:20:25.948 +01:00 [Information] Sending file. Request path: '"/swagger-ui.css"'. Physical path: '"N/A"'
2020-09-12 06:20:25.950 +01:00 [Information] Sending file. Request path: '"/swagger-ui-bundle.js"'. Physical path: '"N/A"'
2020-09-12 06:20:25.958 +01:00 [Information] Request finished in 603.004ms 200 text/css
2020-09-12 06:20:25.962 +01:00 [Information] Request finished in 602.8557ms 200 application/javascript
2020-09-12 06:20:25.972 +01:00 [Information] Request finished in 598.4354ms 200 application/javascript
2020-09-12 06:20:26.319 +01:00 [Information] Request starting HTTP/1.1 GET https://localhost:44363/swagger/swagger-ui-bundle.js.map  
2020-09-12 06:20:26.324 +01:00 [Information] Request finished in 5.4791ms 404 
2020-09-12 06:20:26.539 +01:00 [Information] Request starting HTTP/1.1 GET https://localhost:44363/swagger/swagger-ui-standalone-preset.js.map  
2020-09-12 06:20:26.546 +01:00 [Information] Request finished in 5.7715ms 404 
2020-09-12 06:20:26.683 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/v1/swagger.json  
2020-09-12 06:20:27.050 +01:00 [Information] Request finished in 366.8783ms 200 application/json;charset=utf-8
2020-09-12 06:20:59.570 +01:00 [Information] Request starting HTTP/2.0 POST https://localhost:44363/api/Sale/ReturnProduct application/json 460
2020-09-12 06:20:59.619 +01:00 [Information] CORS policy execution successful.
2020-09-12 06:20:59.627 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:20:59.711 +01:00 [Information] Route matched with "{action = \"ReturnProduct\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReturnProduct(CRMSystem.Domains.ReturnedStock)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 06:21:06.308 +01:00 [Warning] No type was specified for the decimal column '"Tax"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:21:06.313 +01:00 [Warning] No type was specified for the decimal column '"TaxPercent"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:21:06.316 +01:00 [Warning] No type was specified for the decimal column '"Amount"' on entity type '"Item"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:21:06.320 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:21:06.323 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:21:06.326 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:21:06.329 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:21:06.331 +01:00 [Warning] No type was specified for the decimal column '"NairaEquivalent"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:21:06.334 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountForeign"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:21:06.340 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountNaira"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:21:06.348 +01:00 [Warning] No type was specified for the decimal column '"CompetencyValue"' on entity type '"StaffSkillorKPI"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:21:06.433 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 06:21:07.731 +01:00 [Information] Executed DbCommand ("142"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 06:21:08.181 +01:00 [Information] Executed DbCommand ("100"ms) [Parameters=["@__invID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[Amount0], [t].[Code], [t].[DateCreated1], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [c].[ID] AS [ID1], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated1], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE [s].[InvoiceID] = @__invID_0
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID1] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID1], [i0].[ID]"
2020-09-12 06:21:12.538 +01:00 [Information] Executed DbCommand ("90"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Carts] ([Amount], [Code], [DateCreated], [DateModified], [TransactionType], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ID]
FROM [Carts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:21:21.246 +01:00 [Information] Executed DbCommand ("10"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:21:21.305 +01:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:21:21.329 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:21:21.351 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:21:21.392 +01:00 [Information] Executed DbCommand ("6"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:21:21.408 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:24:16.934 +01:00 [Information] Executed DbCommand ("25"ms) [Parameters=["@__data_ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(2) [c].[ID], [c].[Amount], [c].[Code], [c].[DateCreated], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
FROM [Carts] AS [c]
WHERE [c].[ID] = @__data_ID_0"
2020-09-12 06:24:16.948 +01:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@p7='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Carts] SET [Amount] = @p0, [Code] = @p1, [DateCreated] = @p2, [DateModified] = @p3, [TransactionType] = @p4, [UserCreated] = @p5, [UserModified] = @p6
WHERE [ID] = @p7;
SELECT @@ROWCOUNT;"
2020-09-12 06:24:21.062 +01:00 [Error] Failed executing DbCommand ("87"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Decimal)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ReturnedStocks] ([CartID], [DateCreated], [InvoiceNo], [RefundAmount])
VALUES (@p0, @p1, @p2, @p3);
SELECT [ID]
FROM [ReturnedStocks]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:24:21.182 +01:00 [Error] An exception occurred in the database while saving changes for context type '"CRMSystem.Infrastructure.TContext"'."
""Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint \"FK_ReturnedStocks_Carts_CartID\". The conflict occurred in database \"CRMSystemDb\", table \"dbo.Carts\", column 'ID'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:a4c81062-c3ba-4019-b506-038dd0d39090
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ReturnedStocks_Carts_CartID". The conflict occurred in database "CRMSystemDb", table "dbo.Carts", column 'ID'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:a4c81062-c3ba-4019-b506-038dd0d39090
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2020-09-12 06:24:22.116 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)" in 202389.2827ms
2020-09-12 06:24:22.120 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:24:22.231 +01:00 [Error] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ReturnedStocks_Carts_CartID". The conflict occurred in database "CRMSystemDb", table "dbo.Carts", column 'ID'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:a4c81062-c3ba-4019-b506-038dd0d39090
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at CRMSystem.Infrastructure.ReturnedStockRepo.insertAsync(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Infrastructure.Core\Repository\ReturnedStockRepo.cs:line 55
   at CRMSystem.Domains.SaleService.CreateRefund(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Domains.Core\Implementations\SaleService.cs:line 412
   at CRMSystem.Presentation.SaleController.ReturnProduct(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\TunnexCRM\Controllers\SaleController.cs:line 150
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-09-12 06:24:22.268 +01:00 [Information] Request finished in 202705.8301ms 500 text/plain
2020-09-12 06:24:52.523 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 06:24:52.744 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/values  
2020-09-12 06:24:52.892 +01:00 [Information] Request finished in 153.1798ms 404 
2020-09-12 06:24:58.234 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/index.html  
2020-09-12 06:24:58.290 +01:00 [Information] Request finished in 56.8237ms 200 text/html;charset=utf-8
2020-09-12 06:24:58.604 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/v1/swagger.json  
2020-09-12 06:24:58.803 +01:00 [Information] Request finished in 198.8679ms 200 application/json;charset=utf-8
2020-09-12 06:25:16.170 +01:00 [Information] Request starting HTTP/2.0 POST https://localhost:44363/api/Sale/ReturnProduct application/json 460
2020-09-12 06:25:16.190 +01:00 [Information] CORS policy execution successful.
2020-09-12 06:25:16.192 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:25:16.247 +01:00 [Information] Route matched with "{action = \"ReturnProduct\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReturnProduct(CRMSystem.Domains.ReturnedStock)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 06:25:17.471 +01:00 [Warning] No type was specified for the decimal column '"Tax"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:25:17.472 +01:00 [Warning] No type was specified for the decimal column '"TaxPercent"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:25:17.472 +01:00 [Warning] No type was specified for the decimal column '"Amount"' on entity type '"Item"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:25:17.472 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:25:17.472 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:25:17.473 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:25:17.473 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:25:17.473 +01:00 [Warning] No type was specified for the decimal column '"NairaEquivalent"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:25:17.473 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountForeign"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:25:17.473 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountNaira"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:25:17.473 +01:00 [Warning] No type was specified for the decimal column '"CompetencyValue"' on entity type '"StaffSkillorKPI"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:25:17.528 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 06:25:18.553 +01:00 [Information] Executed DbCommand ("107"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 06:25:18.880 +01:00 [Information] Executed DbCommand ("16"ms) [Parameters=["@__invID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[Amount0], [t].[Code], [t].[DateCreated1], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [c].[ID] AS [ID1], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated1], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE [s].[InvoiceID] = @__invID_0
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID1] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID1], [i0].[ID]"
2020-09-12 06:25:19.156 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Carts] ([Amount], [Code], [DateCreated], [DateModified], [TransactionType], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ID]
FROM [Carts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:25:19.281 +01:00 [Information] Executed DbCommand ("0"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:25:19.317 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:25:19.327 +01:00 [Information] Executed DbCommand ("0"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:25:19.331 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:25:19.344 +01:00 [Information] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:25:19.347 +01:00 [Information] Executed DbCommand ("0"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:25:19.369 +01:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@__data_ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(2) [c].[ID], [c].[Amount], [c].[Code], [c].[DateCreated], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
FROM [Carts] AS [c]
WHERE [c].[ID] = @__data_ID_0"
2020-09-12 06:25:19.391 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)" in 3129.482ms
2020-09-12 06:25:19.392 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:25:19.480 +01:00 [Error] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at CRMSystem.Infrastructure.CartRepo.updateAsync(Cart data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Infrastructure.Core\Repository\CartRepo.cs:line 102
   at CRMSystem.Domains.SaleService.CreateRefund(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Domains.Core\Implementations\SaleService.cs:line 407
   at CRMSystem.Presentation.SaleController.ReturnProduct(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\TunnexCRM\Controllers\SaleController.cs:line 150
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-09-12 06:25:19.503 +01:00 [Information] Request finished in 3333.1399ms 500 text/plain
2020-09-12 06:28:53.535 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 06:28:53.732 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/values  
2020-09-12 06:28:53.848 +01:00 [Information] Request finished in 120.2554ms 404 
2020-09-12 06:28:59.104 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/index.html  
2020-09-12 06:28:59.167 +01:00 [Information] Request finished in 63.263ms 200 text/html;charset=utf-8
2020-09-12 06:28:59.422 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/v1/swagger.json  
2020-09-12 06:28:59.645 +01:00 [Information] Request finished in 223.5426ms 200 application/json;charset=utf-8
2020-09-12 06:29:13.014 +01:00 [Information] Request starting HTTP/2.0 POST https://localhost:44363/api/Sale/ReturnProduct application/json 460
2020-09-12 06:29:13.037 +01:00 [Information] CORS policy execution successful.
2020-09-12 06:29:13.040 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:29:13.120 +01:00 [Information] Route matched with "{action = \"ReturnProduct\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReturnProduct(CRMSystem.Domains.ReturnedStock)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 06:29:14.608 +01:00 [Warning] No type was specified for the decimal column '"Tax"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:29:14.608 +01:00 [Warning] No type was specified for the decimal column '"TaxPercent"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:29:14.608 +01:00 [Warning] No type was specified for the decimal column '"Amount"' on entity type '"Item"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:29:14.608 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:29:14.608 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:29:14.608 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:29:14.609 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:29:14.609 +01:00 [Warning] No type was specified for the decimal column '"NairaEquivalent"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:29:14.610 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountForeign"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:29:14.612 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountNaira"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:29:14.613 +01:00 [Warning] No type was specified for the decimal column '"CompetencyValue"' on entity type '"StaffSkillorKPI"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:29:14.674 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 06:29:15.640 +01:00 [Information] Executed DbCommand ("110"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 06:29:15.889 +01:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@__invID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[Amount0], [t].[Code], [t].[DateCreated1], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [c].[ID] AS [ID1], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated1], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE [s].[InvoiceID] = @__invID_0
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID1] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID1], [i0].[ID]"
2020-09-12 06:29:16.120 +01:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Carts] ([Amount], [Code], [DateCreated], [DateModified], [TransactionType], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ID]
FROM [Carts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:29:16.239 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:29:16.277 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:29:16.289 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:29:16.292 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:29:16.310 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:29:16.317 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:29:16.330 +01:00 [Information] Executed DbCommand ("0"ms) [Parameters=["@__data_ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(2) [c].[ID], [c].[Amount], [c].[Code], [c].[DateCreated], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
FROM [Carts] AS [c]
WHERE [c].[ID] = @__data_ID_0"
2020-09-12 06:29:16.333 +01:00 [Information] Executed DbCommand ("0"ms) [Parameters=["@p7='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Carts] SET [Amount] = @p0, [Code] = @p1, [DateCreated] = @p2, [DateModified] = @p3, [TransactionType] = @p4, [UserCreated] = @p5, [UserModified] = @p6
WHERE [ID] = @p7;
SELECT @@ROWCOUNT;"
2020-09-12 06:29:16.359 +01:00 [Error] Failed executing DbCommand ("5"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Decimal)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ReturnedStocks] ([CartID], [DateCreated], [InvoiceNo], [RefundAmount])
VALUES (@p0, @p1, @p2, @p3);
SELECT [ID]
FROM [ReturnedStocks]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:29:16.421 +01:00 [Error] An exception occurred in the database while saving changes for context type '"CRMSystem.Infrastructure.TContext"'."
""Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint \"FK_ReturnedStocks_Carts_CartID\". The conflict occurred in database \"CRMSystemDb\", table \"dbo.Carts\", column 'ID'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:21c8bbb2-5350-496d-a678-52fe4bc8b5d2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ReturnedStocks_Carts_CartID". The conflict occurred in database "CRMSystemDb", table "dbo.Carts", column 'ID'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:21c8bbb2-5350-496d-a678-52fe4bc8b5d2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2020-09-12 06:29:16.489 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)" in 3361.2338ms
2020-09-12 06:29:16.490 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:29:16.732 +01:00 [Error] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ReturnedStocks_Carts_CartID". The conflict occurred in database "CRMSystemDb", table "dbo.Carts", column 'ID'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:21c8bbb2-5350-496d-a678-52fe4bc8b5d2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at CRMSystem.Infrastructure.ReturnedStockRepo.insertAsync(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Infrastructure.Core\Repository\ReturnedStockRepo.cs:line 54
   at CRMSystem.Domains.SaleService.CreateRefund(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Domains.Core\Implementations\SaleService.cs:line 412
   at CRMSystem.Presentation.SaleController.ReturnProduct(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\TunnexCRM\Controllers\SaleController.cs:line 150
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-09-12 06:29:16.758 +01:00 [Information] Request finished in 3744.7164ms 500 text/plain
2020-09-12 06:30:37.965 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 06:30:38.170 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/values  
2020-09-12 06:30:38.289 +01:00 [Information] Request finished in 122.6869ms 404 
2020-09-12 06:30:44.403 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/index.html  
2020-09-12 06:30:44.466 +01:00 [Information] Request finished in 63.7328ms 200 text/html;charset=utf-8
2020-09-12 06:30:44.708 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/v1/swagger.json  
2020-09-12 06:30:44.954 +01:00 [Information] Request finished in 245.6917ms 200 application/json;charset=utf-8
2020-09-12 06:30:59.558 +01:00 [Information] Request starting HTTP/2.0 POST https://localhost:44363/api/Sale/ReturnProduct application/json 460
2020-09-12 06:30:59.577 +01:00 [Information] CORS policy execution successful.
2020-09-12 06:30:59.582 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:30:59.655 +01:00 [Information] Route matched with "{action = \"ReturnProduct\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReturnProduct(CRMSystem.Domains.ReturnedStock)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 06:31:01.193 +01:00 [Warning] No type was specified for the decimal column '"Tax"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:31:01.193 +01:00 [Warning] No type was specified for the decimal column '"TaxPercent"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:31:01.193 +01:00 [Warning] No type was specified for the decimal column '"Amount"' on entity type '"Item"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:31:01.193 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:31:01.193 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:31:01.194 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:31:01.194 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:31:01.194 +01:00 [Warning] No type was specified for the decimal column '"NairaEquivalent"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:31:01.194 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountForeign"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:31:01.194 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountNaira"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:31:01.195 +01:00 [Warning] No type was specified for the decimal column '"CompetencyValue"' on entity type '"StaffSkillorKPI"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:31:01.268 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 06:31:02.476 +01:00 [Information] Executed DbCommand ("150"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 06:31:02.830 +01:00 [Information] Executed DbCommand ("17"ms) [Parameters=["@__invID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[Amount0], [t].[Code], [t].[DateCreated1], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [c].[ID] AS [ID1], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated1], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE [s].[InvoiceID] = @__invID_0
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID1] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID1], [i0].[ID]"
2020-09-12 06:31:03.124 +01:00 [Information] Executed DbCommand ("6"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Carts] ([Amount], [Code], [DateCreated], [DateModified], [TransactionType], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ID]
FROM [Carts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:31:03.206 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:31:03.253 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:31:03.267 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:31:03.273 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:31:03.458 +01:00 [Information] Executed DbCommand ("163"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:31:03.472 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:31:03.497 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@__data_ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(2) [c].[ID], [c].[Amount], [c].[Code], [c].[DateCreated], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
FROM [Carts] AS [c]
WHERE [c].[ID] = @__data_ID_0"
2020-09-12 06:31:03.507 +01:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@p7='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Carts] SET [Amount] = @p0, [Code] = @p1, [DateCreated] = @p2, [DateModified] = @p3, [TransactionType] = @p4, [UserCreated] = @p5, [UserModified] = @p6
WHERE [ID] = @p7;
SELECT @@ROWCOUNT;"
2020-09-12 06:31:03.567 +01:00 [Information] Executed DbCommand ("29"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Decimal)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ReturnedStocks] ([CartID], [DateCreated], [InvoiceNo], [RefundAmount])
VALUES (@p0, @p1, @p2, @p3);
SELECT [ID]
FROM [ReturnedStocks]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:31:03.584 +01:00 [Information] Executing ObjectResult, writing value of type '"System.Int32"'.
2020-09-12 06:31:03.626 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)" in 3959.0877ms
2020-09-12 06:31:03.627 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:31:03.635 +01:00 [Information] Request finished in 4077.1429ms 200 application/json; charset=utf-8
2020-09-12 06:45:09.660 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 06:45:10.257 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/values  
2020-09-12 06:45:10.455 +01:00 [Information] Request finished in 208.1071ms 404 
2020-09-12 06:45:16.722 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger  
2020-09-12 06:45:16.749 +01:00 [Information] Request finished in 49.5729ms 301 
2020-09-12 06:45:16.755 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/index.html  
2020-09-12 06:45:16.831 +01:00 [Information] Request finished in 66.5251ms 200 text/html;charset=utf-8
2020-09-12 06:45:16.886 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/swagger-ui-bundle.js  
2020-09-12 06:45:16.888 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/swagger-ui.css  
2020-09-12 06:45:16.893 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/swagger-ui-standalone-preset.js  
2020-09-12 06:45:17.098 +01:00 [Information] Sending file. Request path: '"/swagger-ui.css"'. Physical path: '"N/A"'
2020-09-12 06:45:17.098 +01:00 [Information] Sending file. Request path: '"/swagger-ui-standalone-preset.js"'. Physical path: '"N/A"'
2020-09-12 06:45:17.106 +01:00 [Information] Request finished in 217.3119ms 200 text/css
2020-09-12 06:45:17.107 +01:00 [Information] Request finished in 218.5703ms 200 application/javascript
2020-09-12 06:45:17.182 +01:00 [Information] Sending file. Request path: '"/swagger-ui-bundle.js"'. Physical path: '"N/A"'
2020-09-12 06:45:17.193 +01:00 [Information] Request finished in 302.7302ms 200 application/javascript
2020-09-12 06:45:17.730 +01:00 [Information] Request starting HTTP/1.1 GET https://localhost:44363/swagger/swagger-ui-bundle.js.map  
2020-09-12 06:45:17.739 +01:00 [Information] Request finished in 11.404ms 404 
2020-09-12 06:45:17.994 +01:00 [Information] Request starting HTTP/1.1 GET https://localhost:44363/swagger/swagger-ui-standalone-preset.js.map  
2020-09-12 06:45:18.012 +01:00 [Information] Request finished in 7.0402ms 404 
2020-09-12 06:45:18.244 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/v1/swagger.json  
2020-09-12 06:45:18.615 +01:00 [Information] Request finished in 391.2514ms 200 application/json;charset=utf-8
2020-09-12 06:47:36.592 +01:00 [Information] Request starting HTTP/2.0 POST https://localhost:44363/api/Sale/SaveSale application/json 2511
2020-09-12 06:47:36.624 +01:00 [Information] CORS policy execution successful.
2020-09-12 06:47:36.654 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)"'
2020-09-12 06:47:36.723 +01:00 [Information] Route matched with "{action = \"Save\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Save(CRMSystem.Domains.Sale)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 06:47:45.055 +01:00 [Warning] No type was specified for the decimal column '"Tax"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:47:45.060 +01:00 [Warning] No type was specified for the decimal column '"TaxPercent"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:47:45.063 +01:00 [Warning] No type was specified for the decimal column '"Amount"' on entity type '"Item"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:47:45.072 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:47:45.077 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:47:45.081 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:47:45.087 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:47:45.090 +01:00 [Warning] No type was specified for the decimal column '"NairaEquivalent"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:47:45.094 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountForeign"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:47:45.100 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountNaira"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:47:45.110 +01:00 [Warning] No type was specified for the decimal column '"CompetencyValue"' on entity type '"StaffSkillorKPI"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:47:45.189 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 06:47:46.661 +01:00 [Information] Executed DbCommand ("130"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Carts] ([Amount], [Code], [DateCreated], [DateModified], [TransactionType], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ID]
FROM [Carts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:47:51.126 +01:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:47:51.200 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:47:51.219 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:47:51.230 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:47:51.309 +01:00 [Information] Executed DbCommand ("6"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:47:51.323 +01:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:47:51.358 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@__data_ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(2) [c].[ID], [c].[Amount], [c].[Code], [c].[DateCreated], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
FROM [Carts] AS [c]
WHERE [c].[ID] = @__data_ID_0"
2020-09-12 06:47:51.373 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@p7='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Carts] SET [Amount] = @p0, [Code] = @p1, [DateCreated] = @p2, [DateModified] = @p3, [TransactionType] = @p4, [UserCreated] = @p5, [UserModified] = @p6
WHERE [ID] = @p7;
SELECT @@ROWCOUNT;"
2020-09-12 06:47:51.427 +01:00 [Information] Executed DbCommand ("14"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [i].[ID]
FROM [Invoices] AS [i]
ORDER BY [i].[ID] DESC"
2020-09-12 06:47:54.652 +01:00 [Information] Executed DbCommand ("17"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [CustomerID], [DatePaid], [InvoiceNo], [Method], [Reference], [SaleID], [UserCreated])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT [ID]
FROM [Payments]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:47:54.748 +01:00 [Information] Executed DbCommand ("30"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Decimal), @p9='?' (DbType = Decimal), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (Size = 4000), @p13='?' (DbType = Boolean), @p14='?' (DbType = Decimal), @p15='?' (DbType = Boolean), @p16='?' (Size = 4000), @p17='?' (DbType = Decimal), @p18='?' (Size = 4000), @p19='?' (DbType = Int32), @p20='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Invoices] ([Amount], [AmountPaid], [Balance], [CartID], [CashierID], [CustomerID], [DateCreated], [DateModified], [DeliveryFee], [DiscountPercent], [ExtData], [InvoiceDate], [InvoiceNo], [IsPaid], [Tax], [TaxInclusive], [TaxName], [TaxPercent], [Type], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20);
SELECT [ID]
FROM [Invoices]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:47:56.223 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@__p_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [c].[ID], [c].[Address], [c].[DateCreated], [c].[DateModified], [c].[Email], [c].[FirstName], [c].[Gender], [c].[Image], [c].[LastName], [c].[Phone], [c].[TotalSales], [c].[UserCreated], [c].[UserModified]
FROM [Customers] AS [c]
WHERE [c].[ID] = @__p_0"
2020-09-12 06:47:57.468 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Customers] SET [Address] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Email] = @p3, [FirstName] = @p4, [Gender] = @p5, [Image] = @p6, [LastName] = @p7, [Phone] = @p8, [TotalSales] = @p9, [UserCreated] = @p10, [UserModified] = @p11
WHERE [ID] = @p12;
SELECT @@ROWCOUNT;"
2020-09-12 06:47:57.539 +01:00 [Information] Executed DbCommand ("24"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Decimal), @p5='?' (DbType = Int32), @p6='?' (DbType = Boolean), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Boolean), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Sales] ([CartID], [CustomerID], [DateCreated], [DateModified], [DeliveryFee], [InvoiceID], [IsDeleted], [LPO], [ReturnedStockID], [ToDeliver], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT [ID]
FROM [Sales]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:47:57.576 +01:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Waybills] ([DateCreated], [InvoiceNo], [UserCreated])
VALUES (@p0, @p1, @p2);
SELECT [ID]
FROM [Waybills]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:47:57.606 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [WaybillProducts] ([ProductID], [Quantity], [WaybillID])
VALUES (@p0, @p1, @p2);
SELECT [ID]
FROM [WaybillProducts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:47:57.618 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [WaybillProducts] ([ProductID], [Quantity], [WaybillID])
VALUES (@p0, @p1, @p2);
SELECT [ID]
FROM [WaybillProducts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:47:57.641 +01:00 [Information] Executing ObjectResult, writing value of type '"System.Int32"'.
2020-09-12 06:47:57.687 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)" in 20934.8182ms
2020-09-12 06:47:57.696 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)"'
2020-09-12 06:47:57.708 +01:00 [Information] Request finished in 21120.1539ms 200 application/json; charset=utf-8
2020-09-12 06:48:32.874 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/Sale/GetSalesReportByDate/0/0  
2020-09-12 06:48:32.924 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.GetSalesReportByDate (CRMSystem.Presentation.Core)"'
2020-09-12 06:48:32.951 +01:00 [Information] Route matched with "{action = \"GetSalesReportByDate\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSalesReportByDate(Int32, System.String, System.String)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 06:48:35.559 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 06:48:35.698 +01:00 [Information] Executed DbCommand ("17"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID], [c].[Amount], [c].[Code], [c].[DateCreated], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM [Sales] AS [s]
INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
LEFT JOIN [Items] AS [i0] ON [c].[ID] = [i0].[CartID]
WHERE [s].[IsDeleted] = CAST(0 AS bit)
ORDER BY [s].[ID], [i].[ID], [c].[ID], [i0].[ID]"
2020-09-12 06:48:35.738 +01:00 [Information] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[CRMSystem.Domains.Sale, CRMSystem.Domains.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2020-09-12 06:48:35.771 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.GetSalesReportByDate (CRMSystem.Presentation.Core)" in 2812.7689ms
2020-09-12 06:48:35.776 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.GetSalesReportByDate (CRMSystem.Presentation.Core)"'
2020-09-12 06:48:35.782 +01:00 [Information] Request finished in 2918.7883ms 200 application/json; charset=utf-8
2020-09-12 06:51:21.360 +01:00 [Information] Request starting HTTP/2.0 POST https://localhost:44363/api/Sale/ReturnProduct application/json 460
2020-09-12 06:51:21.369 +01:00 [Information] CORS policy execution successful.
2020-09-12 06:51:21.383 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:51:21.401 +01:00 [Information] Route matched with "{action = \"ReturnProduct\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReturnProduct(CRMSystem.Domains.ReturnedStock)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 06:51:25.728 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 06:51:25.805 +01:00 [Information] Executed DbCommand ("10"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 06:51:25.855 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@__invID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[Amount0], [t].[Code], [t].[DateCreated1], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [c].[ID] AS [ID1], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated1], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE [s].[InvoiceID] = @__invID_0
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID1] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID1], [i0].[ID]"
2020-09-12 06:51:28.059 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Carts] ([Amount], [Code], [DateCreated], [DateModified], [TransactionType], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ID]
FROM [Carts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:51:28.073 +01:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:51:28.088 +01:00 [Information] Executed DbCommand ("6"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:51:28.133 +01:00 [Information] Executed DbCommand ("6"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:51:28.142 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:51:28.163 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:51:28.170 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:51:29.278 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@__data_ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(2) [c].[ID], [c].[Amount], [c].[Code], [c].[DateCreated], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
FROM [Carts] AS [c]
WHERE [c].[ID] = @__data_ID_0"
2020-09-12 06:51:29.291 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p7='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Carts] SET [Amount] = @p0, [Code] = @p1, [DateCreated] = @p2, [DateModified] = @p3, [TransactionType] = @p4, [UserCreated] = @p5, [UserModified] = @p6
WHERE [ID] = @p7;
SELECT @@ROWCOUNT;"
2020-09-12 06:51:29.353 +01:00 [Error] Failed executing DbCommand ("37"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Decimal)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ReturnedStocks] ([CartID], [DateCreated], [InvoiceNo], [RefundAmount])
VALUES (@p0, @p1, @p2, @p3);
SELECT [ID]
FROM [ReturnedStocks]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:51:29.623 +01:00 [Error] An exception occurred in the database while saving changes for context type '"CRMSystem.Infrastructure.TContext"'."
""Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint \"FK_ReturnedStocks_Carts_CartID\". The conflict occurred in database \"CRMSystemDb\", table \"dbo.Carts\", column 'ID'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:50f25cb9-a025-450d-abff-e11b8eb41c4c
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ReturnedStocks_Carts_CartID". The conflict occurred in database "CRMSystemDb", table "dbo.Carts", column 'ID'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:50f25cb9-a025-450d-abff-e11b8eb41c4c
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2020-09-12 06:51:30.237 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)" in 8832.8397ms
2020-09-12 06:51:30.245 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:51:30.557 +01:00 [Error] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ReturnedStocks_Carts_CartID". The conflict occurred in database "CRMSystemDb", table "dbo.Carts", column 'ID'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:50f25cb9-a025-450d-abff-e11b8eb41c4c
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at CRMSystem.Infrastructure.ReturnedStockRepo.insertAsync(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Infrastructure.Core\Repository\ReturnedStockRepo.cs:line 55
   at CRMSystem.Domains.SaleService.CreateRefund(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Domains.Core\Implementations\SaleService.cs:line 412
   at CRMSystem.Presentation.SaleController.ReturnProduct(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\TunnexCRM\Controllers\SaleController.cs:line 150
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-09-12 06:51:30.589 +01:00 [Information] Request finished in 9243.3215ms 500 text/plain
2020-09-12 06:51:44.930 +01:00 [Information] Request starting HTTP/2.0 POST https://localhost:44363/api/Sale/ReturnProduct application/json 460
2020-09-12 06:51:44.938 +01:00 [Information] CORS policy execution successful.
2020-09-12 06:51:44.957 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:51:44.979 +01:00 [Information] Route matched with "{action = \"ReturnProduct\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReturnProduct(CRMSystem.Domains.ReturnedStock)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 06:51:47.149 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 06:51:47.162 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 06:51:47.179 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@__invID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[Amount0], [t].[Code], [t].[DateCreated1], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [c].[ID] AS [ID1], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated1], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE [s].[InvoiceID] = @__invID_0
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID1] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID1], [i0].[ID]"
2020-09-12 06:51:48.632 +01:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Carts] ([Amount], [Code], [DateCreated], [DateModified], [TransactionType], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ID]
FROM [Carts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:51:48.646 +01:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:51:48.661 +01:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:51:48.675 +01:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:51:48.689 +01:00 [Information] Executed DbCommand ("4"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:51:48.698 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:51:48.704 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:51:58.911 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@__data_ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(2) [c].[ID], [c].[Amount], [c].[Code], [c].[DateCreated], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
FROM [Carts] AS [c]
WHERE [c].[ID] = @__data_ID_0"
2020-09-12 06:51:59.014 +01:00 [Information] Executed DbCommand ("90"ms) [Parameters=["@p7='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Carts] SET [Amount] = @p0, [Code] = @p1, [DateCreated] = @p2, [DateModified] = @p3, [TransactionType] = @p4, [UserCreated] = @p5, [UserModified] = @p6
WHERE [ID] = @p7;
SELECT @@ROWCOUNT;"
2020-09-12 06:52:22.366 +01:00 [Error] Failed executing DbCommand ("12"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Decimal)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ReturnedStocks] ([CartID], [DateCreated], [InvoiceNo], [RefundAmount])
VALUES (@p0, @p1, @p2, @p3);
SELECT [ID]
FROM [ReturnedStocks]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:52:22.398 +01:00 [Error] An exception occurred in the database while saving changes for context type '"CRMSystem.Infrastructure.TContext"'."
""Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint \"FK_ReturnedStocks_Carts_CartID\". The conflict occurred in database \"CRMSystemDb\", table \"dbo.Carts\", column 'ID'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:50f25cb9-a025-450d-abff-e11b8eb41c4c
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ReturnedStocks_Carts_CartID". The conflict occurred in database "CRMSystemDb", table "dbo.Carts", column 'ID'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:50f25cb9-a025-450d-abff-e11b8eb41c4c
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2020-09-12 06:52:23.053 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)" in 38066.3441ms
2020-09-12 06:52:23.061 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:52:23.092 +01:00 [Error] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ReturnedStocks_Carts_CartID". The conflict occurred in database "CRMSystemDb", table "dbo.Carts", column 'ID'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:50f25cb9-a025-450d-abff-e11b8eb41c4c
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at CRMSystem.Infrastructure.ReturnedStockRepo.insertAsync(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Infrastructure.Core\Repository\ReturnedStockRepo.cs:line 55
   at CRMSystem.Domains.SaleService.CreateRefund(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Domains.Core\Implementations\SaleService.cs:line 412
   at CRMSystem.Presentation.SaleController.ReturnProduct(ReturnedStock data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\TunnexCRM\Controllers\SaleController.cs:line 150
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-09-12 06:52:23.114 +01:00 [Information] Request finished in 38178.8181ms 500 text/plain
2020-09-12 06:53:39.363 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 06:53:39.635 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/values  
2020-09-12 06:53:39.761 +01:00 [Information] Request finished in 134.2399ms 404 
2020-09-12 06:53:45.711 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/index.html  
2020-09-12 06:53:45.773 +01:00 [Information] Request finished in 64.384ms 200 text/html;charset=utf-8
2020-09-12 06:53:46.180 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/v1/swagger.json  
2020-09-12 06:53:46.434 +01:00 [Information] Request finished in 254.6222ms 200 application/json;charset=utf-8
2020-09-12 06:53:58.716 +01:00 [Information] Request starting HTTP/2.0 POST https://localhost:44363/api/Sale/ReturnProduct application/json 460
2020-09-12 06:53:58.737 +01:00 [Information] CORS policy execution successful.
2020-09-12 06:53:58.739 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:53:58.809 +01:00 [Information] Route matched with "{action = \"ReturnProduct\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReturnProduct(CRMSystem.Domains.ReturnedStock)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 06:54:00.181 +01:00 [Warning] No type was specified for the decimal column '"Tax"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:54:00.181 +01:00 [Warning] No type was specified for the decimal column '"TaxPercent"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:54:00.181 +01:00 [Warning] No type was specified for the decimal column '"Amount"' on entity type '"Item"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:54:00.182 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:54:00.182 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:54:00.182 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:54:00.182 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:54:00.182 +01:00 [Warning] No type was specified for the decimal column '"NairaEquivalent"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:54:00.182 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountForeign"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:54:00.182 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountNaira"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:54:00.182 +01:00 [Warning] No type was specified for the decimal column '"CompetencyValue"' on entity type '"StaffSkillorKPI"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 06:54:00.242 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 06:54:01.467 +01:00 [Information] Executed DbCommand ("138"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 06:54:01.691 +01:00 [Information] Executed DbCommand ("6"ms) [Parameters=["@__invID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[Amount0], [t].[Code], [t].[DateCreated1], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [c].[ID] AS [ID1], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated1], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE [s].[InvoiceID] = @__invID_0
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID1] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID1], [i0].[ID]"
2020-09-12 06:54:01.954 +01:00 [Information] Executed DbCommand ("5"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Carts] ([Amount], [Code], [DateCreated], [DateModified], [TransactionType], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ID]
FROM [Carts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:54:02.046 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:54:02.086 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:54:02.098 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 06:54:02.101 +01:00 [Information] Executed DbCommand ("0"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 06:54:02.116 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:54:02.120 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:54:02.137 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@__data_ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(2) [c].[ID], [c].[Amount], [c].[Code], [c].[DateCreated], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
FROM [Carts] AS [c]
WHERE [c].[ID] = @__data_ID_0"
2020-09-12 06:54:02.142 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@p7='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Carts] SET [Amount] = @p0, [Code] = @p1, [DateCreated] = @p2, [DateModified] = @p3, [TransactionType] = @p4, [UserCreated] = @p5, [UserModified] = @p6
WHERE [ID] = @p7;
SELECT @@ROWCOUNT;"
2020-09-12 06:54:02.166 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Decimal)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ReturnedStocks] ([CartID], [DateCreated], [InvoiceNo], [RefundAmount])
VALUES (@p0, @p1, @p2, @p3);
SELECT [ID]
FROM [ReturnedStocks]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 06:54:02.181 +01:00 [Information] Executing ObjectResult, writing value of type '"System.Int32"'.
2020-09-12 06:54:02.197 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)" in 3378.8126ms
2020-09-12 06:54:02.199 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 06:54:02.203 +01:00 [Information] Request finished in 3487.4928ms 200 application/json; charset=utf-8
2020-09-12 07:00:03.186 +01:00 [Information] Request starting HTTP/2.0 POST https://localhost:44363/api/Sale/ReturnProduct application/json 460
2020-09-12 07:00:03.193 +01:00 [Information] CORS policy execution successful.
2020-09-12 07:00:03.194 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 07:00:03.196 +01:00 [Information] Route matched with "{action = \"ReturnProduct\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ReturnProduct(CRMSystem.Domains.ReturnedStock)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 07:00:03.315 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 07:00:03.323 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 07:00:03.327 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@__invID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[Amount0], [t].[Code], [t].[DateCreated1], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [c].[ID] AS [ID1], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated1], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE [s].[InvoiceID] = @__invID_0
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID1] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID1], [i0].[ID]"
2020-09-12 07:00:03.334 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Carts] ([Amount], [Code], [DateCreated], [DateModified], [TransactionType], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ID]
FROM [Carts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:00:03.347 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 07:00:03.353 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 07:00:03.357 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 07:00:03.361 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 07:00:03.410 +01:00 [Information] Executed DbCommand ("3"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:00:03.412 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:00:03.416 +01:00 [Information] Executed DbCommand ("2"ms) [Parameters=["@__data_ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(2) [c].[ID], [c].[Amount], [c].[Code], [c].[DateCreated], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
FROM [Carts] AS [c]
WHERE [c].[ID] = @__data_ID_0"
2020-09-12 07:00:03.419 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p7='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Carts] SET [Amount] = @p0, [Code] = @p1, [DateCreated] = @p2, [DateModified] = @p3, [TransactionType] = @p4, [UserCreated] = @p5, [UserModified] = @p6
WHERE [ID] = @p7;
SELECT @@ROWCOUNT;"
2020-09-12 07:00:03.427 +01:00 [Information] Executed DbCommand ("1"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Decimal)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [ReturnedStocks] ([CartID], [DateCreated], [InvoiceNo], [RefundAmount])
VALUES (@p0, @p1, @p2, @p3);
SELECT [ID]
FROM [ReturnedStocks]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:00:03.432 +01:00 [Information] Executing ObjectResult, writing value of type '"System.Int32"'.
2020-09-12 07:00:03.432 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)" in 208.9451ms
2020-09-12 07:00:03.433 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.ReturnProduct (CRMSystem.Presentation.Core)"'
2020-09-12 07:00:03.433 +01:00 [Information] Request finished in 247.9651ms 200 application/json; charset=utf-8
2020-09-12 07:39:48.820 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 07:39:54.511 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/values  
2020-09-12 07:39:55.500 +01:00 [Information] Request finished in 961.8288ms 404 
2020-09-12 07:40:04.402 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger  
2020-09-12 07:40:04.459 +01:00 [Information] Request finished in 24.3923ms 301 
2020-09-12 07:40:04.531 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/index.html  
2020-09-12 07:40:05.628 +01:00 [Information] Request finished in 1117.804ms 200 text/html;charset=utf-8
2020-09-12 07:40:05.973 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/swagger-ui-bundle.js  
2020-09-12 07:40:05.981 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/swagger-ui.css  
2020-09-12 07:40:06.044 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/swagger-ui-standalone-preset.js  
2020-09-12 07:40:06.835 +01:00 [Information] Sending file. Request path: '"/swagger-ui.css"'. Physical path: '"N/A"'
2020-09-12 07:40:06.879 +01:00 [Information] Sending file. Request path: '"/swagger-ui-standalone-preset.js"'. Physical path: '"N/A"'
2020-09-12 07:40:06.903 +01:00 [Information] Request finished in 950.4862ms 200 application/javascript
2020-09-12 07:40:06.943 +01:00 [Information] Request finished in 961.7033ms 200 text/css
2020-09-12 07:40:07.082 +01:00 [Information] Sending file. Request path: '"/swagger-ui-bundle.js"'. Physical path: '"N/A"'
2020-09-12 07:40:07.183 +01:00 [Information] Request finished in 1221.1365ms 200 application/javascript
2020-09-12 07:40:08.639 +01:00 [Information] Request starting HTTP/1.1 GET https://localhost:44363/swagger/swagger-ui-bundle.js.map  
2020-09-12 07:40:08.685 +01:00 [Information] Request finished in 47.6155ms 404 
2020-09-12 07:40:09.036 +01:00 [Information] Request starting HTTP/1.1 GET https://localhost:44363/swagger/swagger-ui-standalone-preset.js.map  
2020-09-12 07:40:09.051 +01:00 [Information] Request finished in 15.2572ms 404 
2020-09-12 07:40:09.395 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/v1/swagger.json  
2020-09-12 07:40:10.200 +01:00 [Information] Request finished in 805.7897ms 200 application/json;charset=utf-8
2020-09-12 07:41:03.532 +01:00 [Information] Request starting HTTP/2.0 POST https://localhost:44363/api/Sale/SaveSale application/json 2509
2020-09-12 07:41:03.635 +01:00 [Information] CORS policy execution successful.
2020-09-12 07:41:03.686 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)"'
2020-09-12 07:41:03.968 +01:00 [Information] Route matched with "{action = \"Save\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Save(CRMSystem.Domains.Sale)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 07:41:23.774 +01:00 [Warning] No type was specified for the decimal column '"Tax"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 07:41:23.781 +01:00 [Warning] No type was specified for the decimal column '"TaxPercent"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 07:41:23.797 +01:00 [Warning] No type was specified for the decimal column '"Amount"' on entity type '"Item"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 07:41:23.812 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 07:41:23.834 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 07:41:23.848 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 07:41:23.856 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 07:41:23.863 +01:00 [Warning] No type was specified for the decimal column '"NairaEquivalent"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 07:41:23.882 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountForeign"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 07:41:23.895 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountNaira"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 07:41:23.900 +01:00 [Warning] No type was specified for the decimal column '"CompetencyValue"' on entity type '"StaffSkillorKPI"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 07:41:24.078 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 07:41:29.155 +01:00 [Information] Executed DbCommand ("540"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Carts] ([Amount], [Code], [DateCreated], [DateModified], [TransactionType], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ID]
FROM [Carts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:41:35.184 +01:00 [Information] Executed DbCommand ("278"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 07:41:35.971 +01:00 [Information] Executed DbCommand ("296"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [PurchaseProducts] ([Amount], [cartID], [productID])
VALUES (@p0, @p1, @p2);
SELECT [ID]
FROM [PurchaseProducts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:41:58.632 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)" in 54610.1178ms
2020-09-12 07:41:58.651 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)"'
2020-09-12 07:41:58.736 +01:00 [Error] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at CRMSystem.Domains.CartService.SaveCart(Cart data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Domains.Core\Implementations\CartService.cs:line 66
   at CRMSystem.Domains.SaleService.Save(Sale data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Domains.Core\Implementations\SaleService.cs:line 50
   at CRMSystem.Presentation.SaleController.Save(Sale data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\TunnexCRM\Controllers\SaleController.cs:line 32
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-09-12 07:41:58.836 +01:00 [Information] Request finished in 55311.7709ms 500 text/plain
2020-09-12 07:42:18.639 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/Product/GetAllProducts  
2020-09-12 07:42:18.655 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.ProductController.GetAllProducts (CRMSystem.Presentation.Core)"'
2020-09-12 07:42:18.698 +01:00 [Information] Route matched with "{action = \"GetAllProducts\", controller = \"Product\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllProducts()" on controller "CRMSystem.Presentation.ProductController" ("CRMSystem.Presentation.Core").
2020-09-12 07:42:18.785 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 07:42:19.145 +01:00 [Information] Executed DbCommand ("331"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]"
2020-09-12 07:42:19.290 +01:00 [Information] Executing ObjectResult, writing value of type '"System.Collections.Generic.List`1[[CRMSystem.Domains.Product, CRMSystem.Domains.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]"'.
2020-09-12 07:42:19.396 +01:00 [Information] Executed action "CRMSystem.Presentation.ProductController.GetAllProducts (CRMSystem.Presentation.Core)" in 688.7252ms
2020-09-12 07:42:19.404 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.ProductController.GetAllProducts (CRMSystem.Presentation.Core)"'
2020-09-12 07:42:19.415 +01:00 [Information] Request finished in 778.9837ms 200 application/json; charset=utf-8
2020-09-12 07:42:51.154 +01:00 [Information] Request starting HTTP/2.0 POST https://localhost:44363/api/Sale/SaveSale application/json 2509
2020-09-12 07:42:51.183 +01:00 [Information] CORS policy execution successful.
2020-09-12 07:42:51.197 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)"'
2020-09-12 07:42:51.208 +01:00 [Information] Route matched with "{action = \"Save\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Save(CRMSystem.Domains.Sale)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 07:42:54.716 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 07:42:55.367 +01:00 [Information] Executed DbCommand ("283"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Carts] ([Amount], [Code], [DateCreated], [DateModified], [TransactionType], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ID]
FROM [Carts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:42:57.792 +01:00 [Information] Executed DbCommand ("334"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 07:42:58.651 +01:00 [Information] Executed DbCommand ("579"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [PurchaseProducts] ([Amount], [cartID], [productID])
VALUES (@p0, @p1, @p2);
SELECT [ID]
FROM [PurchaseProducts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:43:54.376 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)" in 63150.4107ms
2020-09-12 07:43:54.400 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)"'
2020-09-12 07:43:54.419 +01:00 [Error] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at CRMSystem.Domains.CartService.SaveCart(Cart data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Domains.Core\Implementations\CartService.cs:line 66
   at CRMSystem.Domains.SaleService.Save(Sale data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Domains.Core\Implementations\SaleService.cs:line 50
   at CRMSystem.Presentation.SaleController.Save(Sale data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\TunnexCRM\Controllers\SaleController.cs:line 32
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-09-12 07:43:54.456 +01:00 [Information] Request finished in 63307.8666ms 500 text/plain
2020-09-12 07:45:29.076 +01:00 [Information] Request starting HTTP/2.0 POST https://localhost:44363/api/Sale/SaveSale application/json 2600
2020-09-12 07:45:29.125 +01:00 [Information] CORS policy execution successful.
2020-09-12 07:45:29.136 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)"'
2020-09-12 07:45:29.151 +01:00 [Information] Route matched with "{action = \"Save\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Save(CRMSystem.Domains.Sale)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 07:45:34.842 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 07:45:35.454 +01:00 [Information] Executed DbCommand ("299"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Carts] ([Amount], [Code], [DateCreated], [DateModified], [TransactionType], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ID]
FROM [Carts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:45:37.938 +01:00 [Information] Executed DbCommand ("354"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 07:45:38.674 +01:00 [Information] Executed DbCommand ("355"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 07:45:39.311 +01:00 [Information] Executed DbCommand ("288"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 07:45:40.010 +01:00 [Information] Executed DbCommand ("373"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 07:45:40.952 +01:00 [Information] Executed DbCommand ("283"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:45:41.259 +01:00 [Information] Executed DbCommand ("298"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:45:41.848 +01:00 [Information] Executed DbCommand ("305"ms) [Parameters=["@__data_ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(2) [c].[ID], [c].[Amount], [c].[Code], [c].[DateCreated], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
FROM [Carts] AS [c]
WHERE [c].[ID] = @__data_ID_0"
2020-09-12 07:45:42.386 +01:00 [Information] Executed DbCommand ("261"ms) [Parameters=["@p7='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Carts] SET [Amount] = @p0, [Code] = @p1, [DateCreated] = @p2, [DateModified] = @p3, [TransactionType] = @p4, [UserCreated] = @p5, [UserModified] = @p6
WHERE [ID] = @p7;
SELECT @@ROWCOUNT;"
2020-09-12 07:45:43.311 +01:00 [Information] Executed DbCommand ("400"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [i].[ID]
FROM [Invoices] AS [i]
ORDER BY [i].[ID] DESC"
2020-09-12 07:45:48.465 +01:00 [Information] Executed DbCommand ("311"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [CustomerID], [DatePaid], [InvoiceNo], [Method], [Reference], [SaleID], [UserCreated])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT [ID]
FROM [Payments]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:45:49.528 +01:00 [Information] Executed DbCommand ("267"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Decimal), @p9='?' (DbType = Decimal), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (Size = 4000), @p13='?' (DbType = Boolean), @p14='?' (DbType = Decimal), @p15='?' (DbType = Boolean), @p16='?' (Size = 4000), @p17='?' (DbType = Decimal), @p18='?' (Size = 4000), @p19='?' (DbType = Int32), @p20='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Invoices] ([Amount], [AmountPaid], [Balance], [CartID], [CashierID], [CustomerID], [DateCreated], [DateModified], [DeliveryFee], [DiscountPercent], [ExtData], [InvoiceDate], [InvoiceNo], [IsPaid], [Tax], [TaxInclusive], [TaxName], [TaxPercent], [Type], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20);
SELECT [ID]
FROM [Invoices]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:45:52.531 +01:00 [Information] Executed DbCommand ("450"ms) [Parameters=["@__p_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [c].[ID], [c].[Address], [c].[DateCreated], [c].[DateModified], [c].[Email], [c].[FirstName], [c].[Gender], [c].[Image], [c].[LastName], [c].[Phone], [c].[TotalSales], [c].[UserCreated], [c].[UserModified]
FROM [Customers] AS [c]
WHERE [c].[ID] = @__p_0"
2020-09-12 07:45:54.515 +01:00 [Information] Executed DbCommand ("383"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Customers] SET [Address] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Email] = @p3, [FirstName] = @p4, [Gender] = @p5, [Image] = @p6, [LastName] = @p7, [Phone] = @p8, [TotalSales] = @p9, [UserCreated] = @p10, [UserModified] = @p11
WHERE [ID] = @p12;
SELECT @@ROWCOUNT;"
2020-09-12 07:45:55.672 +01:00 [Error] Failed executing DbCommand ("510"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Decimal), @p5='?' (DbType = Int32), @p6='?' (DbType = Boolean), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Boolean), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Sales] ([CartID], [CustomerID], [DateCreated], [DateModified], [DeliveryFee], [InvoiceID], [IsDeleted], [LPO], [ReturnedStockID], [ToDeliver], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT [ID]
FROM [Sales]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:45:56.283 +01:00 [Error] An exception occurred in the database while saving changes for context type '"CRMSystem.Infrastructure.TContext"'."
""Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ReturnedStockID'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:2b4b2f4c-3170-4e55-ab4e-90384b2e973c
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ReturnedStockID'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:2b4b2f4c-3170-4e55-ab4e-90384b2e973c
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2020-09-12 07:45:56.934 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)" in 27780.2315ms
2020-09-12 07:45:56.943 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)"'
2020-09-12 07:45:56.994 +01:00 [Error] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ReturnedStockID'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:2b4b2f4c-3170-4e55-ab4e-90384b2e973c
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at CRMSystem.Infrastructure.SaleRepo.insertAsync(Sale data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Infrastructure.Core\Repository\SaleRepo.cs:line 148
   at CRMSystem.Domains.SaleService.Save(Sale data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Domains.Core\Implementations\SaleService.cs:line 152
   at CRMSystem.Presentation.SaleController.Save(Sale data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\TunnexCRM\Controllers\SaleController.cs:line 32
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-09-12 07:45:57.016 +01:00 [Information] Request finished in 27947.5307ms 500 text/plain
2020-09-12 07:47:56.374 +01:00 [Information] Request starting HTTP/2.0 POST https://localhost:44363/api/Sale/SaveSale application/json 2600
2020-09-12 07:47:56.398 +01:00 [Information] CORS policy execution successful.
2020-09-12 07:47:56.403 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)"'
2020-09-12 07:47:56.412 +01:00 [Information] Route matched with "{action = \"Save\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Save(CRMSystem.Domains.Sale)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 07:48:02.548 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 07:48:03.197 +01:00 [Information] Executed DbCommand ("306"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Carts] ([Amount], [Code], [DateCreated], [DateModified], [TransactionType], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ID]
FROM [Carts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:48:05.709 +01:00 [Information] Executed DbCommand ("286"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 07:48:06.488 +01:00 [Information] Executed DbCommand ("423"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 07:48:07.100 +01:00 [Information] Executed DbCommand ("332"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 07:48:07.872 +01:00 [Information] Executed DbCommand ("274"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 07:48:08.919 +01:00 [Information] Executed DbCommand ("269"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:48:09.198 +01:00 [Information] Executed DbCommand ("272"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:48:09.872 +01:00 [Information] Executed DbCommand ("308"ms) [Parameters=["@__data_ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(2) [c].[ID], [c].[Amount], [c].[Code], [c].[DateCreated], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
FROM [Carts] AS [c]
WHERE [c].[ID] = @__data_ID_0"
2020-09-12 07:48:10.567 +01:00 [Information] Executed DbCommand ("281"ms) [Parameters=["@p7='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Carts] SET [Amount] = @p0, [Code] = @p1, [DateCreated] = @p2, [DateModified] = @p3, [TransactionType] = @p4, [UserCreated] = @p5, [UserModified] = @p6
WHERE [ID] = @p7;
SELECT @@ROWCOUNT;"
2020-09-12 07:48:11.271 +01:00 [Information] Executed DbCommand ("384"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [i].[ID]
FROM [Invoices] AS [i]
ORDER BY [i].[ID] DESC"
2020-09-12 07:48:15.281 +01:00 [Information] Executed DbCommand ("364"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [CustomerID], [DatePaid], [InvoiceNo], [Method], [Reference], [SaleID], [UserCreated])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT [ID]
FROM [Payments]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:48:16.302 +01:00 [Information] Executed DbCommand ("331"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Decimal), @p9='?' (DbType = Decimal), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (Size = 4000), @p13='?' (DbType = Boolean), @p14='?' (DbType = Decimal), @p15='?' (DbType = Boolean), @p16='?' (Size = 4000), @p17='?' (DbType = Decimal), @p18='?' (Size = 4000), @p19='?' (DbType = Int32), @p20='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Invoices] ([Amount], [AmountPaid], [Balance], [CartID], [CashierID], [CustomerID], [DateCreated], [DateModified], [DeliveryFee], [DiscountPercent], [ExtData], [InvoiceDate], [InvoiceNo], [IsPaid], [Tax], [TaxInclusive], [TaxName], [TaxPercent], [Type], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20);
SELECT [ID]
FROM [Invoices]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:48:25.210 +01:00 [Information] Executed DbCommand ("372"ms) [Parameters=["@__p_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [c].[ID], [c].[Address], [c].[DateCreated], [c].[DateModified], [c].[Email], [c].[FirstName], [c].[Gender], [c].[Image], [c].[LastName], [c].[Phone], [c].[TotalSales], [c].[UserCreated], [c].[UserModified]
FROM [Customers] AS [c]
WHERE [c].[ID] = @__p_0"
2020-09-12 07:48:41.156 +01:00 [Information] Executed DbCommand ("573"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Customers] SET [Address] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Email] = @p3, [FirstName] = @p4, [Gender] = @p5, [Image] = @p6, [LastName] = @p7, [Phone] = @p8, [TotalSales] = @p9, [UserCreated] = @p10, [UserModified] = @p11
WHERE [ID] = @p12;
SELECT @@ROWCOUNT;"
2020-09-12 07:48:52.930 +01:00 [Error] Failed executing DbCommand ("377"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Decimal), @p5='?' (DbType = Int32), @p6='?' (DbType = Boolean), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Boolean), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Sales] ([CartID], [CustomerID], [DateCreated], [DateModified], [DeliveryFee], [InvoiceID], [IsDeleted], [LPO], [ReturnedStockID], [ToDeliver], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT [ID]
FROM [Sales]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:48:53.327 +01:00 [Error] An exception occurred in the database while saving changes for context type '"CRMSystem.Infrastructure.TContext"'."
""Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ReturnedStockID'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:2b4b2f4c-3170-4e55-ab4e-90384b2e973c
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)"
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ReturnedStockID'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:2b4b2f4c-3170-4e55-ab4e-90384b2e973c
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2020-09-12 07:48:54.135 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)" in 57715.3232ms
2020-09-12 07:48:54.141 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)"'
2020-09-12 07:48:54.165 +01:00 [Error] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Invalid column name 'ReturnedStockID'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:2b4b2f4c-3170-4e55-ab4e-90384b2e973c
Error Number:207,State:1,Class:16
   --- End of inner exception stack trace ---
   at CRMSystem.Infrastructure.SaleRepo.insertAsync(Sale data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Infrastructure.Core\Repository\SaleRepo.cs:line 148
   at CRMSystem.Domains.SaleService.Save(Sale data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\CRMSystem.Domains.Core\Implementations\SaleService.cs:line 152
   at CRMSystem.Presentation.SaleController.Save(Sale data) in C:\Users\PC\Source\Repos\kolatcole\TunnexCRM\TunnexCRM\Controllers\SaleController.cs:line 32
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-09-12 07:48:54.193 +01:00 [Information] Request finished in 57825.7307ms 500 text/plain
2020-09-12 07:50:41.951 +01:00 [Information] Request starting HTTP/2.0 POST https://localhost:44363/api/Sale/SaveSale application/json 2600
2020-09-12 07:50:41.958 +01:00 [Information] CORS policy execution successful.
2020-09-12 07:50:41.967 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)"'
2020-09-12 07:50:41.972 +01:00 [Information] Route matched with "{action = \"Save\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Save(CRMSystem.Domains.Sale)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 07:50:46.622 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 07:50:47.295 +01:00 [Information] Executed DbCommand ("257"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Carts] ([Amount], [Code], [DateCreated], [DateModified], [TransactionType], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
SELECT [ID]
FROM [Carts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:50:48.997 +01:00 [Information] Executed DbCommand ("340"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 07:50:49.571 +01:00 [Information] Executed DbCommand ("313"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 07:50:50.219 +01:00 [Information] Executed DbCommand ("312"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [p].[ID], [p].[CostPrice], [p].[DateCreated], [p].[DateModified], [p].[Description], [p].[Image], [p].[Location], [p].[Name], [p].[Quantity], [p].[SalePrice], [p].[StockLevel], [p].[TotalSold], [p].[UserCreated], [p].[UserModified]
FROM [Products] AS [p]
WHERE [p].[ID] = @__ID_0"
2020-09-12 07:50:50.782 +01:00 [Information] Executed DbCommand ("263"ms) [Parameters=["@p13='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Int32), @p8='?' (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Products] SET [CostPrice] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Description] = @p3, [Image] = @p4, [Location] = @p5, [Name] = @p6, [Quantity] = @p7, [SalePrice] = @p8, [StockLevel] = @p9, [TotalSold] = @p10, [UserCreated] = @p11, [UserModified] = @p12
WHERE [ID] = @p13;
SELECT @@ROWCOUNT;"
2020-09-12 07:50:51.619 +01:00 [Information] Executed DbCommand ("275"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:50:51.968 +01:00 [Information] Executed DbCommand ("331"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Items] ([Amount], [CartID], [Code], [Name], [ProductID], [Quantity])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
SELECT [ID]
FROM [Items]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:50:52.566 +01:00 [Information] Executed DbCommand ("300"ms) [Parameters=["@__data_ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(2) [c].[ID], [c].[Amount], [c].[Code], [c].[DateCreated], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
FROM [Carts] AS [c]
WHERE [c].[ID] = @__data_ID_0"
2020-09-12 07:50:53.306 +01:00 [Information] Executed DbCommand ("353"ms) [Parameters=["@p7='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Boolean), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Carts] SET [Amount] = @p0, [Code] = @p1, [DateCreated] = @p2, [DateModified] = @p3, [TransactionType] = @p4, [UserCreated] = @p5, [UserModified] = @p6
WHERE [ID] = @p7;
SELECT @@ROWCOUNT;"
2020-09-12 07:50:53.984 +01:00 [Information] Executed DbCommand ("369"ms) [Parameters=[""], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [i].[ID]
FROM [Invoices] AS [i]
ORDER BY [i].[ID] DESC"
2020-09-12 07:50:58.273 +01:00 [Information] Executed DbCommand ("291"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = Int32), @p7='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Payments] ([Amount], [CustomerID], [DatePaid], [InvoiceNo], [Method], [Reference], [SaleID], [UserCreated])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
SELECT [ID]
FROM [Payments]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:50:59.225 +01:00 [Information] Executed DbCommand ("310"ms) [Parameters=["@p0='?' (DbType = Decimal), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Decimal), @p9='?' (DbType = Decimal), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (Size = 4000), @p13='?' (DbType = Boolean), @p14='?' (DbType = Decimal), @p15='?' (DbType = Boolean), @p16='?' (Size = 4000), @p17='?' (DbType = Decimal), @p18='?' (Size = 4000), @p19='?' (DbType = Int32), @p20='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Invoices] ([Amount], [AmountPaid], [Balance], [CartID], [CashierID], [CustomerID], [DateCreated], [DateModified], [DeliveryFee], [DiscountPercent], [ExtData], [InvoiceDate], [InvoiceNo], [IsPaid], [Tax], [TaxInclusive], [TaxName], [TaxPercent], [Type], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20);
SELECT [ID]
FROM [Invoices]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:51:01.933 +01:00 [Information] Executed DbCommand ("394"ms) [Parameters=["@__p_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [c].[ID], [c].[Address], [c].[DateCreated], [c].[DateModified], [c].[Email], [c].[FirstName], [c].[Gender], [c].[Image], [c].[LastName], [c].[Phone], [c].[TotalSales], [c].[UserCreated], [c].[UserModified]
FROM [Customers] AS [c]
WHERE [c].[ID] = @__p_0"
2020-09-12 07:51:03.635 +01:00 [Information] Executed DbCommand ("363"ms) [Parameters=["@p12='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
UPDATE [Customers] SET [Address] = @p0, [DateCreated] = @p1, [DateModified] = @p2, [Email] = @p3, [FirstName] = @p4, [Gender] = @p5, [Image] = @p6, [LastName] = @p7, [Phone] = @p8, [TotalSales] = @p9, [UserCreated] = @p10, [UserModified] = @p11
WHERE [ID] = @p12;
SELECT @@ROWCOUNT;"
2020-09-12 07:51:04.652 +01:00 [Information] Executed DbCommand ("333"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Decimal), @p5='?' (DbType = Int32), @p6='?' (DbType = Boolean), @p7='?' (Size = 4000), @p8='?' (DbType = Int32), @p9='?' (DbType = Boolean), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Sales] ([CartID], [CustomerID], [DateCreated], [DateModified], [DeliveryFee], [InvoiceID], [IsDeleted], [LPO], [ReturnedStockID], [ToDeliver], [UserCreated], [UserModified])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
SELECT [ID]
FROM [Sales]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:51:05.672 +01:00 [Information] Executed DbCommand ("317"ms) [Parameters=["@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [Waybills] ([DateCreated], [InvoiceNo], [UserCreated])
VALUES (@p0, @p1, @p2);
SELECT [ID]
FROM [Waybills]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:51:06.906 +01:00 [Information] Executed DbCommand ("510"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [WaybillProducts] ([ProductID], [Quantity], [WaybillID])
VALUES (@p0, @p1, @p2);
SELECT [ID]
FROM [WaybillProducts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:51:07.284 +01:00 [Information] Executed DbCommand ("369"ms) [Parameters=["@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SET NOCOUNT ON;
INSERT INTO [WaybillProducts] ([ProductID], [Quantity], [WaybillID])
VALUES (@p0, @p1, @p2);
SELECT [ID]
FROM [WaybillProducts]
WHERE @@ROWCOUNT = 1 AND [ID] = scope_identity();"
2020-09-12 07:51:07.548 +01:00 [Information] Executing ObjectResult, writing value of type '"System.Int32"'.
2020-09-12 07:51:07.561 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)" in 25579.4908ms
2020-09-12 07:51:07.571 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.Save (CRMSystem.Presentation.Core)"'
2020-09-12 07:51:07.575 +01:00 [Information] Request finished in 25623.443ms 200 application/json; charset=utf-8
2020-09-12 07:51:28.686 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/Sale/GetSaleByID/11  
2020-09-12 07:51:28.701 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.Get (CRMSystem.Presentation.Core)"'
2020-09-12 07:51:28.767 +01:00 [Information] Route matched with "{action = \"Get\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(Int32)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 07:51:33.012 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 07:51:33.677 +01:00 [Information] Executed DbCommand ("343"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[Amount0], [t].[Code], [t].[DateCreated1], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [c].[ID] AS [ID1], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated1], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE ([s].[InvoiceID] = @__ID_0) AND ([s].[IsDeleted] = CAST(0 AS bit))
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID1] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID1], [i0].[ID]"
2020-09-12 21:05:42.564 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 21:05:43.651 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/index.html  
2020-09-12 21:05:43.651 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/values  
2020-09-12 21:05:43.925 +01:00 [Information] Request finished in 267.1468ms 0 
2020-09-12 21:05:44.016 +01:00 [Information] Request finished in 373.7608ms 200 text/html;charset=utf-8
2020-09-12 21:05:45.266 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/v1/swagger.json  
2020-09-12 21:05:45.707 +01:00 [Information] Request finished in 442.3887ms 200 application/json;charset=utf-8
2020-09-12 21:06:02.852 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/Sale/GetSaleWithPayments/0000031  
2020-09-12 21:06:02.862 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.GetSaleWithPayments (CRMSystem.Presentation.Core)"'
2020-09-12 21:06:03.016 +01:00 [Information] Route matched with "{action = \"GetSaleWithPayments\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSaleWithPayments(System.String)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 21:06:05.524 +01:00 [Warning] No type was specified for the decimal column '"Tax"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:06:05.525 +01:00 [Warning] No type was specified for the decimal column '"TaxPercent"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:06:05.525 +01:00 [Warning] No type was specified for the decimal column '"Amount"' on entity type '"Item"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:06:05.526 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:06:05.528 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:06:05.528 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:06:05.529 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:06:05.529 +01:00 [Warning] No type was specified for the decimal column '"NairaEquivalent"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:06:05.529 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountForeign"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:06:05.529 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountNaira"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:06:05.529 +01:00 [Warning] No type was specified for the decimal column '"CompetencyValue"' on entity type '"StaffSkillorKPI"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:06:05.694 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 21:06:10.646 +01:00 [Information] Executed DbCommand ("436"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 21:06:11.471 +01:00 [Information] Executed DbCommand ("493"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[Amount0], [t].[Code], [t].[DateCreated1], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [c].[ID] AS [ID1], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated1], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE ([s].[InvoiceID] = @__ID_0) AND ([s].[IsDeleted] = CAST(0 AS bit))
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID1] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID1], [i0].[ID]"
2020-09-12 21:06:11.881 +01:00 [Information] Executed DbCommand ("358"ms) [Parameters=["@__invNo_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [p].[ID], [p].[Amount], [p].[CustomerID], [p].[DatePaid], [p].[InvoiceNo], [p].[Method], [p].[Reference], [p].[SaleID], [p].[UserCreated]
FROM [Payments] AS [p]
WHERE [p].[InvoiceNo] = @__invNo_0"
2020-09-12 21:06:11.912 +01:00 [Information] Executing ObjectResult, writing value of type '"CRMSystem.Domains.Sale"'.
2020-09-12 21:06:11.974 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.GetSaleWithPayments (CRMSystem.Presentation.Core)" in 8942.8107ms
2020-09-12 21:06:11.975 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.GetSaleWithPayments (CRMSystem.Presentation.Core)"'
2020-09-12 21:06:11.984 +01:00 [Information] Request finished in 9132.6198ms 200 application/json; charset=utf-8
2020-09-12 21:18:39.176 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 21:18:40.351 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/values  
2020-09-12 21:18:40.746 +01:00 [Information] Request finished in 409.4489ms 404 
2020-09-12 21:18:50.068 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger  
2020-09-12 21:18:50.122 +01:00 [Information] Request finished in 30.6232ms 301 
2020-09-12 21:18:50.134 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/index.html  
2020-09-12 21:18:50.301 +01:00 [Information] Request finished in 151.3438ms 200 text/html;charset=utf-8
2020-09-12 21:18:50.437 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/swagger-ui.css  
2020-09-12 21:18:50.451 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/swagger-ui-bundle.js  
2020-09-12 21:18:50.451 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/swagger-ui-standalone-preset.js  
2020-09-12 21:18:50.794 +01:00 [Information] Sending file. Request path: '"/swagger-ui.css"'. Physical path: '"N/A"'
2020-09-12 21:18:50.843 +01:00 [Information] Sending file. Request path: '"/swagger-ui-standalone-preset.js"'. Physical path: '"N/A"'
2020-09-12 21:18:50.865 +01:00 [Information] Request finished in 459.9366ms 200 text/css
2020-09-12 21:18:50.866 +01:00 [Information] Request finished in 457.6945ms 200 application/javascript
2020-09-12 21:18:51.042 +01:00 [Information] Sending file. Request path: '"/swagger-ui-bundle.js"'. Physical path: '"N/A"'
2020-09-12 21:18:51.061 +01:00 [Information] Request finished in 644.154ms 200 application/javascript
2020-09-12 21:18:52.752 +01:00 [Information] Request starting HTTP/1.1 GET https://localhost:44363/swagger/swagger-ui-bundle.js.map  
2020-09-12 21:18:52.809 +01:00 [Information] Request finished in 68.3171ms 404 
2020-09-12 21:18:53.482 +01:00 [Information] Request starting HTTP/1.1 GET https://localhost:44363/swagger/swagger-ui-standalone-preset.js.map  
2020-09-12 21:18:53.503 +01:00 [Information] Request finished in 12.2056ms 404 
2020-09-12 21:18:53.964 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/v1/swagger.json  
2020-09-12 21:18:54.046 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/favicon-32x32.png  
2020-09-12 21:18:54.166 +01:00 [Information] Sending file. Request path: '"/favicon-32x32.png"'. Physical path: '"N/A"'
2020-09-12 21:18:54.179 +01:00 [Information] Request finished in 224.2598ms 200 image/png
2020-09-12 21:18:54.579 +01:00 [Information] Request finished in 672.5304ms 200 application/json;charset=utf-8
2020-09-12 21:19:19.814 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/Sale/GetSalewithInvoiceNo/0000031  
2020-09-12 21:19:19.855 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)"'
2020-09-12 21:19:19.992 +01:00 [Information] Route matched with "{action = \"GetSalewithInvoiceNo\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSalewithInvoiceNo(System.String)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 21:19:21.966 +01:00 [Warning] No type was specified for the decimal column '"Tax"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:19:21.973 +01:00 [Warning] No type was specified for the decimal column '"TaxPercent"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:19:21.979 +01:00 [Warning] No type was specified for the decimal column '"Amount"' on entity type '"Item"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:19:21.985 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:19:21.993 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:19:21.998 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:19:22.002 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:19:22.011 +01:00 [Warning] No type was specified for the decimal column '"NairaEquivalent"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:19:22.020 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountForeign"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:19:22.039 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountNaira"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:19:22.057 +01:00 [Warning] No type was specified for the decimal column '"CompetencyValue"' on entity type '"StaffSkillorKPI"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:19:22.136 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 21:19:26.631 +01:00 [Information] Executed DbCommand ("541"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 21:20:37.096 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 21:20:37.427 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/values  
2020-09-12 21:20:37.648 +01:00 [Information] Request finished in 227.9606ms 404 
2020-09-12 21:20:44.018 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/index.html  
2020-09-12 21:20:44.138 +01:00 [Information] Request finished in 120.7463ms 200 text/html;charset=utf-8
2020-09-12 21:20:44.508 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/v1/swagger.json  
2020-09-12 21:20:44.881 +01:00 [Information] Request finished in 373.9869ms 200 application/json;charset=utf-8
2020-09-12 21:21:02.456 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/Sale/GetSalewithInvoiceNo/0000031  
2020-09-12 21:21:02.465 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)"'
2020-09-12 21:21:02.574 +01:00 [Information] Route matched with "{action = \"GetSalewithInvoiceNo\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSalewithInvoiceNo(System.String)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 21:21:04.440 +01:00 [Warning] No type was specified for the decimal column '"Tax"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:21:04.440 +01:00 [Warning] No type was specified for the decimal column '"TaxPercent"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:21:04.440 +01:00 [Warning] No type was specified for the decimal column '"Amount"' on entity type '"Item"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:21:04.440 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:21:04.441 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:21:04.441 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:21:04.441 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:21:04.441 +01:00 [Warning] No type was specified for the decimal column '"NairaEquivalent"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:21:04.442 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountForeign"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:21:04.442 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountNaira"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:21:04.442 +01:00 [Warning] No type was specified for the decimal column '"CompetencyValue"' on entity type '"StaffSkillorKPI"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:21:04.570 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 21:21:07.934 +01:00 [Information] Executed DbCommand ("442"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 21:21:08.656 +01:00 [Information] Executed DbCommand ("368"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[CartID1], [t].[DateCreated1], [t].[InvoiceNo0], [t].[RefundAmount], [t].[ID2], [t].[Amount0], [t].[Code], [t].[DateCreated2], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [r].[ID] AS [ID1], [r].[CartID] AS [CartID1], [r].[DateCreated] AS [DateCreated1], [r].[InvoiceNo] AS [InvoiceNo0], [r].[RefundAmount], [c].[ID] AS [ID2], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated2], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    LEFT JOIN [ReturnedStocks] AS [r] ON [s].[ReturnedStockID] = [r].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE ([s].[InvoiceID] = @__ID_0) AND ([s].[IsDeleted] = CAST(0 AS bit))
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID2] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID2], [i0].[ID]"
2020-09-12 21:21:09.108 +01:00 [Information] Executed DbCommand ("387"ms) [Parameters=["@__invNo_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [p].[ID], [p].[Amount], [p].[CustomerID], [p].[DatePaid], [p].[InvoiceNo], [p].[Method], [p].[Reference], [p].[SaleID], [p].[UserCreated]
FROM [Payments] AS [p]
WHERE [p].[InvoiceNo] = @__invNo_0"
2020-09-12 21:21:09.134 +01:00 [Information] Executing ObjectResult, writing value of type '"CRMSystem.Domains.Sale"'.
2020-09-12 21:21:09.188 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)" in 6596.6862ms
2020-09-12 21:21:09.189 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)"'
2020-09-12 21:21:09.195 +01:00 [Information] Request finished in 6739.5057ms 200 application/json; charset=utf-8
2020-09-12 21:31:46.170 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 21:31:46.511 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/values  
2020-09-12 21:31:46.755 +01:00 [Information] Request finished in 250.2707ms 404 
2020-09-12 21:31:55.821 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/index.html  
2020-09-12 21:31:55.887 +01:00 [Information] Request finished in 66.6147ms 200 text/html;charset=utf-8
2020-09-12 21:31:56.217 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/v1/swagger.json  
2020-09-12 21:31:56.534 +01:00 [Information] Request finished in 316.7466ms 200 application/json;charset=utf-8
2020-09-12 21:32:20.434 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/Sale/GetSalewithInvoiceNo/0000031  
2020-09-12 21:32:20.444 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)"'
2020-09-12 21:32:20.523 +01:00 [Information] Route matched with "{action = \"GetSalewithInvoiceNo\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSalewithInvoiceNo(System.String)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 21:32:22.099 +01:00 [Warning] No type was specified for the decimal column '"Tax"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:32:22.100 +01:00 [Warning] No type was specified for the decimal column '"TaxPercent"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:32:22.100 +01:00 [Warning] No type was specified for the decimal column '"Amount"' on entity type '"Item"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:32:22.101 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:32:22.101 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:32:22.101 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:32:22.101 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:32:22.102 +01:00 [Warning] No type was specified for the decimal column '"NairaEquivalent"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:32:22.102 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountForeign"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:32:22.102 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountNaira"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:32:22.102 +01:00 [Warning] No type was specified for the decimal column '"CompetencyValue"' on entity type '"StaffSkillorKPI"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:32:22.195 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 21:32:28.442 +01:00 [Information] Executed DbCommand ("939"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 21:32:29.174 +01:00 [Information] Executed DbCommand ("325"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[Amount0], [t].[Code], [t].[DateCreated1], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [c].[ID] AS [ID1], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated1], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE ([s].[InvoiceID] = @__ID_0) AND ([s].[IsDeleted] = CAST(0 AS bit))
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID1] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID1], [i0].[ID]"
2020-09-12 21:32:29.541 +01:00 [Information] Executed DbCommand ("323"ms) [Parameters=["@__invNo_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT TOP(1) [r].[ID], [r].[CartID], [r].[DateCreated], [r].[InvoiceNo], [r].[RefundAmount]
FROM [ReturnedStocks] AS [r]
WHERE [r].[InvoiceNo] = @__invNo_0"
2020-09-12 21:32:29.927 +01:00 [Information] Executed DbCommand ("344"ms) [Parameters=["@__invNo_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [p].[ID], [p].[Amount], [p].[CustomerID], [p].[DatePaid], [p].[InvoiceNo], [p].[Method], [p].[Reference], [p].[SaleID], [p].[UserCreated]
FROM [Payments] AS [p]
WHERE [p].[InvoiceNo] = @__invNo_0"
2020-09-12 21:32:29.961 +01:00 [Information] Executing ObjectResult, writing value of type '"CRMSystem.Domains.Sale"'.
2020-09-12 21:32:30.032 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)" in 9489.0541ms
2020-09-12 21:32:30.034 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)"'
2020-09-12 21:32:30.043 +01:00 [Information] Request finished in 9610.8791ms 200 application/json; charset=utf-8
2020-09-12 21:38:16.326 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 21:38:16.701 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/values  
2020-09-12 21:38:16.884 +01:00 [Information] Request finished in 208.4576ms 404 
2020-09-12 21:38:18.929 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/index.html  
2020-09-12 21:38:19.021 +01:00 [Information] Request finished in 93.2052ms 200 text/html;charset=utf-8
2020-09-12 21:38:19.403 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/v1/swagger.json  
2020-09-12 21:38:19.691 +01:00 [Information] Request finished in 288.162ms 200 application/json;charset=utf-8
2020-09-12 21:38:39.808 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/Sale/GetSalewithInvoiceNo/0000031  
2020-09-12 21:38:39.823 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)"'
2020-09-12 21:38:39.906 +01:00 [Information] Route matched with "{action = \"GetSalewithInvoiceNo\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSalewithInvoiceNo(System.String)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 21:38:42.016 +01:00 [Warning] No type was specified for the decimal column '"Tax"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:38:42.017 +01:00 [Warning] No type was specified for the decimal column '"TaxPercent"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:38:42.017 +01:00 [Warning] No type was specified for the decimal column '"Amount"' on entity type '"Item"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:38:42.017 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:38:42.017 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:38:42.018 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:38:42.021 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:38:42.021 +01:00 [Warning] No type was specified for the decimal column '"NairaEquivalent"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:38:42.022 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountForeign"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:38:42.022 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountNaira"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:38:42.022 +01:00 [Warning] No type was specified for the decimal column '"CompetencyValue"' on entity type '"StaffSkillorKPI"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:38:42.127 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 21:38:45.844 +01:00 [Information] Executed DbCommand ("507"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 21:38:48.745 +01:00 [Information] Executed DbCommand ("2,571"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[Amount0], [t].[Code], [t].[DateCreated1], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [c].[ID] AS [ID1], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated1], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE ([s].[InvoiceID] = @__ID_0) AND ([s].[IsDeleted] = CAST(0 AS bit))
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID1] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID1], [i0].[ID]"
2020-09-12 21:38:49.126 +01:00 [Information] Executed DbCommand ("314"ms) [Parameters=["@__invNo_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[DateCreated], [t].[InvoiceNo], [t].[RefundAmount], [t].[ID0], [t].[Amount], [t].[Code], [t].[DateCreated0], [t].[DateModified], [t].[TransactionType], [t].[UserCreated], [t].[UserModified], [i].[ID], [i].[Amount], [i].[CartID], [i].[Code], [i].[Name], [i].[ProductID], [i].[Quantity]
FROM (
    SELECT TOP(1) [r].[ID], [r].[CartID], [r].[DateCreated], [r].[InvoiceNo], [r].[RefundAmount], [c].[ID] AS [ID0], [c].[Amount], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
    FROM [ReturnedStocks] AS [r]
    INNER JOIN [Carts] AS [c] ON [r].[CartID] = [c].[ID]
    WHERE [r].[InvoiceNo] = @__invNo_0
) AS [t]
LEFT JOIN [Items] AS [i] ON [t].[ID0] = [i].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i].[ID]"
2020-09-12 21:38:49.565 +01:00 [Information] Executed DbCommand ("375"ms) [Parameters=["@__invNo_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [p].[ID], [p].[Amount], [p].[CustomerID], [p].[DatePaid], [p].[InvoiceNo], [p].[Method], [p].[Reference], [p].[SaleID], [p].[UserCreated]
FROM [Payments] AS [p]
WHERE [p].[InvoiceNo] = @__invNo_0"
2020-09-12 21:38:49.596 +01:00 [Information] Executing ObjectResult, writing value of type '"CRMSystem.Domains.Sale"'.
2020-09-12 21:38:49.675 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)" in 9742.9736ms
2020-09-12 21:38:49.676 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)"'
2020-09-12 21:38:49.683 +01:00 [Information] Request finished in 9874.9802ms 200 application/json; charset=utf-8
2020-09-12 21:40:53.131 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 21:40:53.488 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/index.html  
2020-09-12 21:40:53.678 +01:00 [Information] Request finished in 191.659ms 200 text/html;charset=utf-8
2020-09-12 21:40:54.235 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/v1/swagger.json  
2020-09-12 21:40:54.256 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/favicon-32x32.png  
2020-09-12 21:40:54.985 +01:00 [Information] Request finished in 760.3283ms 200 application/json;charset=utf-8
2020-09-12 21:40:55.454 +01:00 [Information] Sending file. Request path: '"/favicon-32x32.png"'. Physical path: '"N/A"'
2020-09-12 21:40:55.455 +01:00 [Information] Request finished in 1199.2265ms 200 image/png
2020-09-12 21:41:19.344 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/Sale/GetSalewithInvoiceNo/0000031  
2020-09-12 21:41:19.356 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)"'
2020-09-12 21:41:19.458 +01:00 [Information] Route matched with "{action = \"GetSalewithInvoiceNo\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSalewithInvoiceNo(System.String)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 21:41:22.375 +01:00 [Warning] No type was specified for the decimal column '"Tax"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:41:22.376 +01:00 [Warning] No type was specified for the decimal column '"TaxPercent"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:41:22.376 +01:00 [Warning] No type was specified for the decimal column '"Amount"' on entity type '"Item"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:41:22.376 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:41:22.376 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:41:22.377 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:41:22.377 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:41:22.377 +01:00 [Warning] No type was specified for the decimal column '"NairaEquivalent"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:41:22.377 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountForeign"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:41:22.377 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountNaira"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:41:22.378 +01:00 [Warning] No type was specified for the decimal column '"CompetencyValue"' on entity type '"StaffSkillorKPI"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 21:41:22.695 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 21:41:28.697 +01:00 [Information] Executed DbCommand ("1,167"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 21:41:29.409 +01:00 [Information] Executed DbCommand ("346"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[Amount0], [t].[Code], [t].[DateCreated1], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [c].[ID] AS [ID1], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated1], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE ([s].[InvoiceID] = @__ID_0) AND ([s].[IsDeleted] = CAST(0 AS bit))
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID1] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID1], [i0].[ID]"
2020-09-12 21:41:29.921 +01:00 [Information] Executed DbCommand ("441"ms) [Parameters=["@__invNo_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[DateCreated], [t].[InvoiceNo], [t].[RefundAmount], [t].[ID0], [t].[Amount], [t].[Code], [t].[DateCreated0], [t].[DateModified], [t].[TransactionType], [t].[UserCreated], [t].[UserModified], [i].[ID], [i].[Amount], [i].[CartID], [i].[Code], [i].[Name], [i].[ProductID], [i].[Quantity]
FROM (
    SELECT TOP(1) [r].[ID], [r].[CartID], [r].[DateCreated], [r].[InvoiceNo], [r].[RefundAmount], [c].[ID] AS [ID0], [c].[Amount], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
    FROM [ReturnedStocks] AS [r]
    INNER JOIN [Carts] AS [c] ON [r].[CartID] = [c].[ID]
    WHERE [r].[InvoiceNo] = @__invNo_0
) AS [t]
LEFT JOIN [Items] AS [i] ON [t].[ID0] = [i].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i].[ID]"
2020-09-12 21:41:30.256 +01:00 [Information] Executed DbCommand ("285"ms) [Parameters=["@__invNo_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [p].[ID], [p].[Amount], [p].[CustomerID], [p].[DatePaid], [p].[InvoiceNo], [p].[Method], [p].[Reference], [p].[SaleID], [p].[UserCreated]
FROM [Payments] AS [p]
WHERE [p].[InvoiceNo] = @__invNo_0"
2020-09-12 21:41:30.290 +01:00 [Information] Executing ObjectResult, writing value of type '"CRMSystem.Domains.Sale"'.
2020-09-12 21:41:30.349 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)" in 10873.5898ms
2020-09-12 21:41:30.352 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)"'
2020-09-12 21:41:30.360 +01:00 [Information] Request finished in 11016.3234ms 200 application/json; charset=utf-8
2020-09-12 22:24:40.544 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 22:24:41.529 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/values  
2020-09-12 22:24:41.849 +01:00 [Information] Request finished in 323.2788ms 404 
2020-09-12 22:25:06.132 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/index.html  
2020-09-12 22:25:06.257 +01:00 [Information] Request finished in 126.5779ms 200 text/html;charset=utf-8
2020-09-12 22:25:07.237 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/swagger/v1/swagger.json  
2020-09-12 22:25:07.982 +01:00 [Information] Request finished in 745.2183ms 200 application/json;charset=utf-8
2020-09-12 22:25:47.379 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/Sale/GetSalewithInvoiceNo/0000031  
2020-09-12 22:25:47.414 +01:00 [Information] Executing endpoint '"CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)"'
2020-09-12 22:25:47.609 +01:00 [Information] Route matched with "{action = \"GetSalewithInvoiceNo\", controller = \"Sale\"}". Executing controller action with signature "System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetSalewithInvoiceNo(System.String)" on controller "CRMSystem.Presentation.SaleController" ("CRMSystem.Presentation.Core").
2020-09-12 22:25:49.669 +01:00 [Warning] No type was specified for the decimal column '"Tax"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 22:25:49.669 +01:00 [Warning] No type was specified for the decimal column '"TaxPercent"' on entity type '"Invoice"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 22:25:49.669 +01:00 [Warning] No type was specified for the decimal column '"Amount"' on entity type '"Item"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 22:25:49.670 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 22:25:49.670 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Price"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 22:25:49.670 +01:00 [Warning] No type was specified for the decimal column '"CostPrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 22:25:49.670 +01:00 [Warning] No type was specified for the decimal column '"SalePrice"' on entity type '"Product"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 22:25:49.670 +01:00 [Warning] No type was specified for the decimal column '"NairaEquivalent"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 22:25:49.671 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountForeign"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 22:25:49.671 +01:00 [Warning] No type was specified for the decimal column '"TotalAmountNaira"' on entity type '"Purchase"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 22:25:49.671 +01:00 [Warning] No type was specified for the decimal column '"CompetencyValue"' on entity type '"StaffSkillorKPI"'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values using 'HasColumnType()'.
2020-09-12 22:25:49.781 +01:00 [Information] Entity Framework Core "3.1.4" initialized '"TContext"' using provider '"Microsoft.EntityFrameworkCore.SqlServer"' with options: "MigrationsAssembly=CRMSystem.Presentation.Core "
2020-09-12 22:25:56.526 +01:00 [Information] Executed DbCommand ("797"ms) [Parameters=["@__invNumber_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID], [t].[CashierID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount0], [t].[Code], [t].[DateCreated0], [t].[DateModified0], [t].[TransactionType], [t].[UserCreated0], [t].[UserModified0], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [i].[ID], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID], [i].[CashierID], [i].[CustomerID], [i].[DateCreated], [i].[DateModified], [i].[DeliveryFee], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated], [i].[UserModified], [c].[ID] AS [ID0], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified] AS [DateModified0], [c].[TransactionType], [c].[UserCreated] AS [UserCreated0], [c].[UserModified] AS [UserModified0]
    FROM [Invoices] AS [i]
    INNER JOIN [Carts] AS [c] ON [i].[CartID] = [c].[ID]
    WHERE ([i].[InvoiceNo] = @__invNumber_0) AND ([i].[Type] = N'sale')
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID0] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i0].[ID]"
2020-09-12 22:25:57.629 +01:00 [Information] Executed DbCommand ("672"ms) [Parameters=["@__ID_0='?' (DbType = Int32)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[CustomerID], [t].[DateCreated], [t].[DateModified], [t].[DeliveryFee], [t].[InvoiceID], [t].[IsDeleted], [t].[LPO], [t].[ReturnedStockID], [t].[ToDeliver], [t].[UserCreated], [t].[UserModified], [t].[ID0], [t].[Amount], [t].[AmountPaid], [t].[Balance], [t].[CartID0], [t].[CashierID], [t].[CustomerID0], [t].[DateCreated0], [t].[DateModified0], [t].[DeliveryFee0], [t].[DiscountPercent], [t].[ExtData], [t].[InvoiceDate], [t].[InvoiceNo], [t].[IsPaid], [t].[Tax], [t].[TaxInclusive], [t].[TaxName], [t].[TaxPercent], [t].[Type], [t].[UserCreated0], [t].[UserModified0], [t].[ID1], [t].[Amount0], [t].[Code], [t].[DateCreated1], [t].[DateModified1], [t].[TransactionType], [t].[UserCreated1], [t].[UserModified1], [i0].[ID], [i0].[Amount], [i0].[CartID], [i0].[Code], [i0].[Name], [i0].[ProductID], [i0].[Quantity]
FROM (
    SELECT TOP(1) [s].[ID], [s].[CartID], [s].[CustomerID], [s].[DateCreated], [s].[DateModified], [s].[DeliveryFee], [s].[InvoiceID], [s].[IsDeleted], [s].[LPO], [s].[ReturnedStockID], [s].[ToDeliver], [s].[UserCreated], [s].[UserModified], [i].[ID] AS [ID0], [i].[Amount], [i].[AmountPaid], [i].[Balance], [i].[CartID] AS [CartID0], [i].[CashierID], [i].[CustomerID] AS [CustomerID0], [i].[DateCreated] AS [DateCreated0], [i].[DateModified] AS [DateModified0], [i].[DeliveryFee] AS [DeliveryFee0], [i].[DiscountPercent], [i].[ExtData], [i].[InvoiceDate], [i].[InvoiceNo], [i].[IsPaid], [i].[Tax], [i].[TaxInclusive], [i].[TaxName], [i].[TaxPercent], [i].[Type], [i].[UserCreated] AS [UserCreated0], [i].[UserModified] AS [UserModified0], [c].[ID] AS [ID1], [c].[Amount] AS [Amount0], [c].[Code], [c].[DateCreated] AS [DateCreated1], [c].[DateModified] AS [DateModified1], [c].[TransactionType], [c].[UserCreated] AS [UserCreated1], [c].[UserModified] AS [UserModified1]
    FROM [Sales] AS [s]
    INNER JOIN [Invoices] AS [i] ON [s].[InvoiceID] = [i].[ID]
    INNER JOIN [Carts] AS [c] ON [s].[CartID] = [c].[ID]
    WHERE ([s].[InvoiceID] = @__ID_0) AND ([s].[IsDeleted] = CAST(0 AS bit))
) AS [t]
LEFT JOIN [Items] AS [i0] ON [t].[ID1] = [i0].[CartID]
ORDER BY [t].[ID], [t].[ID0], [t].[ID1], [i0].[ID]"
2020-09-12 22:25:58.450 +01:00 [Information] Executed DbCommand ("677"ms) [Parameters=["@__invNo_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [t].[ID], [t].[CartID], [t].[DateCreated], [t].[InvoiceNo], [t].[RefundAmount], [t].[ID0], [t].[Amount], [t].[Code], [t].[DateCreated0], [t].[DateModified], [t].[TransactionType], [t].[UserCreated], [t].[UserModified], [i].[ID], [i].[Amount], [i].[CartID], [i].[Code], [i].[Name], [i].[ProductID], [i].[Quantity]
FROM (
    SELECT TOP(1) [r].[ID], [r].[CartID], [r].[DateCreated], [r].[InvoiceNo], [r].[RefundAmount], [c].[ID] AS [ID0], [c].[Amount], [c].[Code], [c].[DateCreated] AS [DateCreated0], [c].[DateModified], [c].[TransactionType], [c].[UserCreated], [c].[UserModified]
    FROM [ReturnedStocks] AS [r]
    INNER JOIN [Carts] AS [c] ON [r].[CartID] = [c].[ID]
    WHERE [r].[InvoiceNo] = @__invNo_0
) AS [t]
LEFT JOIN [Items] AS [i] ON [t].[ID0] = [i].[CartID]
ORDER BY [t].[ID], [t].[ID0], [i].[ID]"
2020-09-12 22:25:59.855 +01:00 [Information] Executed DbCommand ("1,282"ms) [Parameters=["@__invNo_0='?' (Size = 4000)"], CommandType='Text', CommandTimeout='30']"
""SELECT [p].[ID], [p].[Amount], [p].[CustomerID], [p].[DatePaid], [p].[InvoiceNo], [p].[Method], [p].[Reference], [p].[SaleID], [p].[UserCreated]
FROM [Payments] AS [p]
WHERE [p].[InvoiceNo] = @__invNo_0"
2020-09-12 22:25:59.885 +01:00 [Information] Executing ObjectResult, writing value of type '"CRMSystem.Domains.Sale"'.
2020-09-12 22:25:59.966 +01:00 [Information] Executed action "CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)" in 12338.225ms
2020-09-12 22:25:59.967 +01:00 [Information] Executed endpoint '"CRMSystem.Presentation.SaleController.GetSalewithInvoiceNo (CRMSystem.Presentation.Core)"'
2020-09-12 22:25:59.971 +01:00 [Information] Request finished in 12592.8708ms 200 application/json; charset=utf-8
2020-09-12 22:32:20.525 +01:00 [Information] User profile is available. Using '"C:\Users\PC\AppData\Local\ASP.NET\DataProtection-Keys"' as key repository and Windows DPAPI to encrypt keys at rest.
2020-09-12 22:32:22.116 +01:00 [Information] Request starting HTTP/2.0 GET https://localhost:44363/api/values  
2020-09-12 22:32:22.404 +01:00 [Information] Request finished in 293.9676ms 404 
